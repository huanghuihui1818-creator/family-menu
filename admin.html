<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸ§° èœå•åå°</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial;max-width:980px;margin:24px auto;padding:0 14px;line-height:1.4}
    .card{border:1px solid #e6e6e6;border-radius:16px;padding:16px;margin:12px 0;box-shadow:0 8px 18px rgba(0,0,0,.04)}
    .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
    label{font-size:13px;color:#555}
    input,select,textarea{border:1px solid #ddd;border-radius:12px;padding:10px 12px;font-size:14px}
    textarea{width:100%;min-height:320px;font-family:ui-monospace,Menlo,Consolas,monospace}
    button{padding:10px 14px;border-radius:12px;border:1px solid #ddd;background:#fff;cursor:pointer}
    button:hover{border-color:#999}
    .muted{color:#666;font-size:13px}
    .pill{display:inline-block;border:1px solid #eee;border-radius:999px;padding:4px 10px;font-size:12px;background:#fafafa}
    .danger{color:#b00020}
    code{background:#f6f6f6;padding:2px 6px;border-radius:8px}
  </style>
</head>
<body>

<div class="row" style="justify-content:space-between">
  <h1>ğŸ§° èœå•åå°</h1>
  <a href="./index.html">â† è¿”å›æŠ½èœå•</a>
</div>

<p class="muted">
  èœå•åº“ï¼ˆmenu.jsonï¼‰éœ€è¦å¤åˆ¶å› GitHub æ‰ä¼šå…¨å®¶åŒæ­¥ã€‚<br>
  å†°ç®± / åå¥½é…ç½®ä¿å­˜åœ¨<strong>æœ¬è®¾å¤‡æµè§ˆå™¨</strong>ï¼Œé¦–é¡µä¼šç›´æ¥è¯»å–ã€‚
</p>

<!-- å†°ç®±åæ¨æ¨¡å¼ -->
<div class="card">
  <h3>ğŸ¥¬ å†°ç®±åæ¨æ¨¡å¼</h3>
  <p class="muted">
    é€‰æ‹©æ¨¡å¼åï¼Œé¦–é¡µéšæœºé€»è¾‘ä¼šå‘ç”Ÿæ ¹æœ¬å˜åŒ–ï¼š
  </p>
  <ul class="muted">
    <li><strong>æ¨èæ¨¡å¼</strong>ï¼šå‘½ä¸­é£Ÿæçš„èœæ›´å®¹æ˜“è¢«æŠ½åˆ°ï¼ˆé»˜è®¤ï¼‰</li>
    <li><strong>ä¸¥æ ¼åæ¨æ¨¡å¼</strong>ï¼šâ—ï¸<strong>åªä»å‘½ä¸­é£Ÿæçš„èœé‡ŒæŠ½</strong></li>
  </ul>

  <div class="row">
    <label>å†°ç®±é‡Œæœ‰ï¼ˆé€—å·åˆ†éš”ï¼‰</label>
    <input id="pantryInp" placeholder="é¸¡è›‹,ç•ªèŒ„,åœŸè±†,è±†è…" style="flex:1;min-width:260px">
  </div>

  <div class="row" style="margin-top:8px">
    <label>åæ¨æ¨¡å¼</label>
    <select id="modeSel">
      <option value="suggest">æ¨èæ¨¡å¼ï¼ˆå‘½ä¸­åŠ æƒï¼‰</option>
      <option value="strict">ä¸¥æ ¼åæ¨ï¼ˆåªå‘½ä¸­é£Ÿæï¼‰</option>
    </select>
  </div>

  <div class="row" style="margin-top:10px">
    <button id="savePantryBtn">ä¿å­˜å†°ç®±é…ç½®</button>
    <button id="clearPantryBtn" class="danger">æ¸…ç©º</button>
    <span class="pill" id="pantryPill">æœªä¿å­˜</span>
  </div>

  <p class="muted" style="margin-top:8px">
    ğŸ’¡ ä¸¥æ ¼åæ¨é€‚åˆï¼š<br>
    ä¸‹ç­å¾ˆç´¯ / ä¸æƒ³å†ä¹°èœ / å°±æƒ³ç”¨ç°æœ‰é£Ÿæã€‚
  </p>
</div>

<script>
const KEY_PANTRY = "family_menu_pantry_v2";
const $ = id => document.getElementById(id);

function normalizeCSV(s){
  return (s||"").split(",").map(x=>x.trim()).filter(Boolean);
}

function loadPantry(){
  try{
    return JSON.parse(localStorage.getItem(KEY_PANTRY)) || { items:[], mode:"suggest" };
  }catch{
    return { items:[], mode:"suggest" };
  }
}

function savePantry(obj){
  localStorage.setItem(KEY_PANTRY, JSON.stringify(obj));
}

function refreshUI(){
  const p = loadPantry();
  $("pantryInp").value = p.items.join(",");
  $("modeSel").value = p.mode || "suggest";
  $("pantryPill").textContent = p.items.length
    ? `å·²ä¿å­˜ï¼ˆ${p.mode==="strict"?"ä¸¥æ ¼åæ¨":"æ¨è"}ï¼‰`
    : "æœªä¿å­˜";
}

$("savePantryBtn").onclick = ()=>{
  const obj = {
    items: normalizeCSV($("pantryInp").value),
    mode: $("modeSel").value
  };
  savePantry(obj);
  refreshUI();
};

$("clearPantryBtn").onclick = ()=>{
  localStorage.removeItem(KEY_PANTRY);
  refreshUI();
};

refreshUI();
</script>

</body>
</html>
